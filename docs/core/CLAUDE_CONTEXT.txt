================================================================================
CPA EXAM BLUEPRINT - CLAUDE CONTEXT
================================================================================
Last Updated: 2026-01-10

This is a comprehensive context file for Claude Code sessions. It contains
complete project history, workflow preferences, golden rules, and detailed
system structure.

================================================================================
TABLE OF CONTENTS
================================================================================

1. PROJECT IDENTITY
2. BUSINESS CONTEXT
3. TECHNICAL ARCHITECTURE
4. COMPLETE FILE STRUCTURE
5. WORKFLOW PREFERENCES
6. GOLDEN RULES
7. PROJECT HISTORY
8. DATABASE SCHEMA (Supabase - ACTIVE)
9. DATA MODELS
10. API REFERENCE
11. STYLING GUIDE
12. PRACTICE QUESTIONS SYSTEM
   12.5 EXAM SIMULATION SYSTEM
   12.6 TBS (TASK-BASED SIMULATION) SYSTEM (NEW 2026-01-10)
13. GAMIFICATION SYSTEM
14. FUTURE ROADMAP
15. KEY DOCUMENTS REFERENCE

================================================================================
1. PROJECT IDENTITY
================================================================================

Name: CPA Exam Blueprint
Tagline: Free CPA Study Plans from Licensed CPAs
Domain: cpa-exam-blueprint.vercel.app (production)
Repository: https://github.com/bkolar18/cpa-exam-blueprint
Owner: bkolar18 (Brenn)

Purpose:
A lead generation website that helps CPA exam candidates with free tools and
study plans, ultimately recommending a CPA review program (Surgent) for
monetization through affiliate commissions.

IMPORTANT CONTEXT:
A family member works at Surgent. The goal of this site is to reduce Surgent's
reliance on affiliate marketing by creating an owned marketing channel that
provides genuine value to CPA candidates and builds trust before recommending
Surgent. Read "CPA Exam Blueprint - Business Overview.txt" for full details.

================================================================================
2. BUSINESS CONTEXT
================================================================================

TARGET AUDIENCE:
- CPA exam candidates (accounting students, career changers)
- Working professionals studying part-time
- Recent graduates preparing for the exam

VALUE PROPOSITION:
- Free personalized study plans (competitors charge for this)
- Free tools (score calendar, NTS tracker, calculator)
- State-specific requirement guides (55 states/jurisdictions)
- 5,810 MCQ practice questions across all 6 sections
- 500+ TBS (Task-Based Simulation) questions across all 6 sections
- Exam simulation mode with timed tests and pause functionality
- User dashboard with progress tracking and gamification
- Guidance from "licensed CPAs" (authority positioning)

MONETIZATION:
- Affiliate Partner: Surgent CPA Review
- Commission: Earned on referral signups
- Lead Capture: Email collection for nurturing
- Dashboard Promo: Surgent banner with 30-day reappearance

COMPETITIVE DIFFERENTIATION:
| Competitors Do          | We Do Instead                    |
|-------------------------|----------------------------------|
| Rank by commission      | Recommend ONE program honestly   |
| Generic tips            | Personalized plans               |
| Anonymous content       | Named CPA credentials            |
| Paid tools              | Free tools that actually help    |
| Transactional           | Ongoing email nurture            |
| No user accounts        | Free dashboard with gamification |

CPA EXAM STRUCTURE (CPA Evolution 2024+):
- 3 Core Sections: FAR, AUD, REG (continuous testing)
- 1 Discipline Section: BAR, TCP, or ISC (quarterly: Jan, Apr, Jul, Oct)
- 18-month rolling window to pass all sections
- Passing score: 75 on each section

PASS RATES (2024-2025):
- FAR: 40-43% (hardest core)
- AUD: 46-50%
- REG: 58-64%
- TCP: 72-82% (highest - easiest discipline)
- BAR: 33-40% (hardest overall)
- ISC: ~51%

================================================================================
3. TECHNICAL ARCHITECTURE
================================================================================

FRAMEWORK & RUNTIME:
- Next.js 16.1.1 (App Router)
- React 19
- TypeScript
- Node.js

STYLING:
- Tailwind CSS v4
- CSS Variables for theming
- No component library (custom components)

DATABASE & AUTH (ACTIVE):
- Supabase (PostgreSQL)
- Supabase Auth (email/password)
- Row Level Security (RLS) enabled

EMAIL:
- Resend API for transactional emails
- Templates: HTML inline styles

DEPLOYMENT:
- Vercel (auto-deploy from GitHub main branch)
- Vercel Analytics enabled

FUTURE ADDITIONS:
- AI: Anthropic Claude API for chatbot (API key exists for scraper)
- Email automation for nurturing sequences

ENVIRONMENT VARIABLES:
```
# Current (Active)
RESEND_API_KEY=re_XEVXzFPr_HsK9GPJzNhGorSNHrpsxo9dU
EMAIL_TO=delivered@resend.dev  # TODO: Set real admin email
NEXT_PUBLIC_SUPABASE_URL=<your-supabase-url>
NEXT_PUBLIC_SUPABASE_ANON_KEY=<your-anon-key>
ANTHROPIC_API_KEY=<for-data-extraction>

# Future
NEXTAUTH_SECRET=
NEXTAUTH_URL=
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
```

================================================================================
4. COMPLETE FILE STRUCTURE
================================================================================

cpa-exam-blueprint/
├── .env.local                    # Environment variables (gitignored)
├── .gitignore
├── next.config.ts
├── package.json
├── tsconfig.json
├── tailwind.config.ts
│
├── PROJECT_ROADMAP.md            # 5-phase implementation plan
├── SESSION_PROMPT.txt            # Quick start for new sessions
├── SESSION_LOG.txt               # Session-by-session accomplishments
├── CLAUDE_CONTEXT.txt            # This file - comprehensive context
├── cpa claude responses.txt      # Strategic planning session logs
├── CPA Exam Blueprint - Business Overview.txt  # Business description for Surgent
│
├── public/
│   └── (static assets)
│
└── src/
    ├── app/
    │   ├── globals.css           # Design system, CSS variables
    │   ├── layout.tsx            # Root layout with Header/Footer
    │   ├── page.tsx              # Home page
    │   │
    │   ├── api/
    │   │   ├── submit-study-plan/
    │   │   │   └── route.ts      # POST: Study plan email + admin notification
    │   │   ├── subscribe-score-release/
    │   │   │   └── route.ts      # POST: Score calendar email subscription
    │   │   └── subscribe-nts/
    │   │       └── route.ts      # POST: NTS tracker email subscription
    │   │
    │   ├── auth/
    │   │   └── callback/
    │   │       └── route.ts      # Supabase auth callback handler
    │   │
    │   ├── login/
    │   │   └── page.tsx          # Login page
    │   ├── signup/
    │   │   └── page.tsx          # Signup page
    │   │
    │   ├── cpa-academy/
    │   │   └── page.tsx          # CPA Academy landing/marketing page
    │   │
    │   ├── dashboard/
    │   │   ├── layout.tsx        # Dashboard layout with sidebar
    │   │   ├── page.tsx          # Main dashboard with stats
    │   │   ├── study-log/
    │   │   │   └── page.tsx      # Log study sessions
    │   │   ├── sections/
    │   │   │   └── page.tsx      # Manage section progress
    │   │   ├── nts/
    │   │   │   └── page.tsx      # Manage NTS entries
    │   │   ├── practice/
    │   │   │   ├── page.tsx      # Practice overview
    │   │   │   ├── [section]/
    │   │   │   │   └── page.tsx  # Section practice questions
    │   │   │   └── history/
    │   │   │       └── page.tsx  # Review past attempts
    │   │   ├── exam-simulation/
    │   │   │   └── [section]/
    │   │   │       └── page.tsx  # Timed exam with pause functionality
    │   │   ├── accolades/
    │   │   │   └── page.tsx      # Badges and achievements
    │   │   └── settings/
    │   │       └── page.tsx      # User preferences
    │   │
    │   ├── study-plan/
    │   │   └── page.tsx          # 5-step quiz with email capture
    │   │
    │   ├── sections/
    │   │   ├── far/page.tsx
    │   │   ├── aud/page.tsx
    │   │   ├── reg/page.tsx
    │   │   └── tcp/page.tsx
    │   │
    │   ├── tools/
    │   │   ├── score-release-calendar/
    │   │   │   └── page.tsx      # Countdown timer, email subscribe
    │   │   ├── nts-tracker/
    │   │   │   └── page.tsx      # Expiration calculator, reminders
    │   │   └── study-hours-calculator/
    │   │       └── page.tsx      # Hours per section calculator
    │   │
    │   ├── state-requirements/
    │   │   ├── page.tsx          # State grid landing page (22 states)
    │   │   └── [state]/
    │   │       └── page.tsx      # Dynamic state detail pages
    │   │
    │   ├── blog/
    │   │   ├── page.tsx          # Blog listing
    │   │   └── [slug]/
    │   │       └── page.tsx      # Individual blog posts (8 articles)
    │   │
    │   ├── guides/
    │   │   ├── exam-day/
    │   │   │   └── page.tsx      # Exam day walkthrough
    │   │   └── failed-section/
    │   │       └── page.tsx      # "I Failed, Now What?" guide
    │   │
    │   ├── success-stories/
    │   │   ├── page.tsx          # Stories listing (5 stories)
    │   │   └── [slug]/
    │   │       └── page.tsx      # Individual story pages
    │   │
    │   ├── recommended-program/
    │   │   └── page.tsx          # Surgent affiliate page
    │   │
    │   ├── working-full-time/
    │   │   └── page.tsx          # Time management tips
    │   │
    │   └── about/
    │       └── page.tsx          # CPA credentials, trust building
    │
    ├── components/
    │   ├── Header.tsx            # Navigation with dropdowns
    │   ├── Footer.tsx            # Site footer
    │   ├── SectionPage.tsx       # Reusable section template
    │   └── auth/
    │       └── AuthProvider.tsx  # Auth context with profile management
    │
    └── lib/
        ├── supabase/
        │   ├── client.ts         # Browser Supabase client
        │   ├── server.ts         # Server Supabase client
        │   └── types.ts          # Database types (Profile, etc.)
        │
        ├── gamification/
        │   ├── types.ts          # Badge, Achievement types
        │   ├── badges.ts         # Badge definitions
        │   └── points.ts         # Point calculations
        │
        └── data/
            ├── practice-questions/
            │   ├── types.ts      # QuestionSet, PracticeQuestion
            │   ├── index.ts      # Exports and helper functions
            │   ├── far.ts        # 100 FAR questions
            │   ├── aud.ts        # 100 AUD questions
            │   ├── reg.ts        # 100 REG questions
            │   ├── tcp.ts        # 100 TCP questions
            │   ├── bar.ts        # 100 BAR questions
            │   └── isc.ts        # 100 ISC questions
            │
            ├── tbs/                     # TBS QUESTIONS (NEW 2026-01-10!)
            │   ├── types.ts             # TBS type definitions
            │   ├── tbs-research-guide.md # Research & creation guidelines
            │   ├── far-tbs.ts           # 19 FAR TBS (need 10 more)
            │   ├── aud-tbs.ts           # 29 AUD TBS
            │   ├── reg-tbs.ts           # 30 REG TBS
            │   ├── tcp-tbs.ts           # 21 TCP TBS
            │   ├── bar-tbs.ts           # 21 BAR TBS
            │   ├── isc-tbs.ts           # 12 ISC TBS
            │   ├── sample-tbs.ts        # 58 original sample TBS
            │   └── index.ts             # Central exports
            │
            ├── score-release-dates.ts  # 2025-2026 release schedule
            ├── state-requirements.ts   # 55 states/jurisdictions data
            ├── blog-posts.ts           # Blog post metadata
            └── success-stories.ts      # Success story data

================================================================================
5. WORKFLOW PREFERENCES
================================================================================

DEVELOPMENT:
- Always run `npm run build` to verify before committing
- Commit frequently with descriptive messages
- Push to trigger Vercel auto-deploy

GIT CONVENTIONS:
- Main branch only (no feature branches for this project)
- Commit messages: Clear, descriptive, include scope
- Always include Claude Code attribution in commits

FILE ORGANIZATION:
- Keep related files together (page + its data)
- Use lib/data/ for static data files
- Prefer editing existing files over creating new ones

CODE STYLE:
- TypeScript strict mode
- Functional components with hooks
- CSS variables for colors (not hardcoded)
- Tailwind utility classes

DOCUMENTATION:
- **CRITICAL**: Log EVERY response to "cpa claude responses.txt" (user cannot read console)
- Update SESSION_LOG.txt after each session
- Update CLAUDE_CONTEXT.txt when major changes occur
- Session files (SESSION_*.txt, CLAUDE_CONTEXT.txt) are local - don't push to GitHub every time

================================================================================
6. GOLDEN RULES
================================================================================

**CRITICAL - TOP PRIORITY:**
1. LOG ALL RESPONSES: Copy EVERY console response to "cpa claude responses.txt"
   - The user CANNOT read responses in the console
   - This is essential for project efficiency and continuity
   - Do this for EVERY response, no exceptions

2. SESSION FILES ARE LOCAL: Do NOT push these to GitHub every update:
   - SESSION_PROMPT.txt
   - SESSION_LOG.txt
   - CLAUDE_CONTEXT.txt
   - Only push when committing actual code changes or when explicitly requested

**STANDARD RULES:**
3. ALWAYS read SESSION_PROMPT.txt at session start
4. ALWAYS update SESSION_LOG.txt at session end
5. NEVER commit .env.local or expose API keys
6. ALWAYS run `npm run build` before committing code
7. PREFER editing existing files over creating new ones
8. KEEP the design consistent (use CSS variables)
9. CAPTURE emails at every opportunity (lead generation focus)
10. MAINTAIN mobile responsiveness on all pages
11. WRITE code that compiles - verify with build
12. DOCUMENT major decisions in this file

================================================================================
7. PROJECT HISTORY
================================================================================

PHASE 0: Initial Setup (Completed)
----------------------------------
- Created Next.js project with TypeScript
- Set up Tailwind CSS v4 with CSS variables
- Built core pages: Home, Study Plan, Sections, About
- Created Header/Footer components
- Implemented study plan quiz with email capture
- Integrated Resend API for emails
- Deployed to Vercel
- Added Vercel Analytics

PHASE 1: Free Tools (Completed 2026-01-03)
------------------------------------------
- Score Release Calendar with countdown timer
- NTS Expiration Tracker with reminder system
- Study Hours Calculator for all 6 sections
- State Requirements Guide (started with 10 states, now 22)
- Enhanced Study Plan with discipline selection
- Added "Free Tools" dropdown to navigation

PHASE 2: Content & Authority (Completed 2026-01-04)
---------------------------------------------------
- MDX blog infrastructure
- 8 blog posts (study guides, pass rates, working full-time, etc.)
- Exam Day Walkthrough guide
- "I Failed, Now What?" retaker guide
- Success Stories section (5 stories)
- Simplified header navigation

PHASE 3: CPA Academy / Dashboard (Completed 2026-01-05, Enhanced 2026-01-08)
----------------------------------------------------------------------------
- Supabase database integration (PostgreSQL)
- User authentication (email/password via Supabase Auth)
- User dashboard with study tracking
- Study session logging with streak tracking
- Section progress management
- NTS tracking in dashboard
- Gamification system (points, badges, achievements)
- 5,810 practice questions across all 6 sections (176 batch files)
- Practice history and accuracy tracking
- Exam simulation mode with timed tests and pause functionality
- Surgent promotional banner (per-account, 30-day reappearance)
- State requirements expanded to 22 states

PHASE 3.5: Question Bank Expansion (In Progress as of 2026-01-10)
-----------------------------------------------------------------
MCQ Questions:
- Expanded from 600 to 5,810 questions
- 176 question batch files in docs/question-batches/
- Difficulty distribution analysis and tracking
- Target: 50-60% medium difficulty (currently at 49.2%)
- See docs/DIFFICULTY-DISTRIBUTION-ANALYSIS.md for full breakdown

TBS Questions (NEW - Added 2026-01-10):
- Created comprehensive TBS folder structure: src/lib/data/tbs/
- 500+ total TBS questions (expanded from 58 sample to 500+)
- Target: 500 total - COMPLETED January 2026
- Created TBS research guide with complexity levels
- TBS types: Numeric Entry, Document Review, Journal Entry, Dropdown, Research
- Complexity distribution: 40% simple, 45% moderate, 15% complex
- See src/lib/data/tbs/tbs-research-guide.md for full details

Dark Mode Fix (2026-01-10):
- Fixed state requirements pages for dark mode readability
- Updated [state]/page.tsx and StateSelector.tsx

PHASE 4: Email Nurturing (NOT STARTED)
--------------------------------------
- 7-email welcome sequence
- Segment-based content delivery
- Automated score release notifications

PHASE 5: AI Features (NOT STARTED)
----------------------------------
- AI chatbot (Anthropic Claude)
- AI-powered study recommendations
- Diagnostic quizzes per section

================================================================================
8. DATABASE SCHEMA (Supabase - ACTIVE)
================================================================================

The database is fully integrated and active. All tables have Row Level Security.

```sql
-- PROFILES TABLE
-- Stores user profile data and gamification stats
CREATE TABLE profiles (
  id UUID PRIMARY KEY REFERENCES auth.users(id),
  email TEXT UNIQUE NOT NULL,
  full_name TEXT,
  state_code TEXT,
  target_completion_date DATE,
  discipline_choice TEXT CHECK (discipline_choice IN ('TCP', 'BAR', 'ISC')),
  weekly_study_hours INTEGER,
  working_full_time BOOLEAN,
  -- Gamification fields
  total_points INTEGER DEFAULT 0,
  badge_count INTEGER DEFAULT 0,
  achievement_count INTEGER DEFAULT 0,
  current_streak INTEGER DEFAULT 0,
  longest_streak INTEGER DEFAULT 0,
  last_study_date DATE,
  promo_dismissed_at TIMESTAMPTZ,  -- For Surgent banner (30-day reappearance)
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);

-- STUDY SESSIONS TABLE
-- Tracks logged study hours
CREATE TABLE study_sessions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  section TEXT NOT NULL CHECK (section IN ('FAR', 'AUD', 'REG', 'TCP', 'BAR', 'ISC')),
  date DATE NOT NULL,
  hours DECIMAL(4,2) NOT NULL,
  notes TEXT,
  topics_covered TEXT[],
  created_at TIMESTAMPTZ DEFAULT now()
);

-- SECTION PROGRESS TABLE
-- Tracks status of each CPA section
CREATE TABLE section_progress (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  section TEXT NOT NULL CHECK (section IN ('FAR', 'AUD', 'REG', 'TCP', 'BAR', 'ISC')),
  status TEXT NOT NULL CHECK (status IN ('not_started', 'studying', 'scheduled', 'passed', 'failed')),
  start_date DATE,
  exam_date DATE,
  score INTEGER,
  attempt_number INTEGER DEFAULT 1,
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now(),
  UNIQUE(user_id, section)
);

-- NTS ENTRIES TABLE
-- Tracks Notice to Schedule documents
CREATE TABLE nts_entries (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  section TEXT NOT NULL CHECK (section IN ('FAR', 'AUD', 'REG', 'TCP', 'BAR', 'ISC')),
  issue_date DATE NOT NULL,
  expiration_date DATE NOT NULL,
  status TEXT NOT NULL CHECK (status IN ('active', 'used', 'expired')),
  exam_scheduled_date DATE,
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);

-- PRACTICE ATTEMPTS TABLE
-- Tracks user answers to practice questions
CREATE TABLE practice_attempts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  question_id TEXT NOT NULL,
  section TEXT NOT NULL CHECK (section IN ('FAR', 'AUD', 'REG', 'TCP', 'BAR', 'ISC')),
  topic TEXT,
  selected_answer TEXT NOT NULL,
  correct_answer TEXT NOT NULL,
  is_correct BOOLEAN NOT NULL,
  time_spent_seconds INTEGER,
  created_at TIMESTAMPTZ DEFAULT now()
);

-- USER BADGES TABLE
-- Tracks earned achievements
CREATE TABLE user_badges (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  badge_id TEXT NOT NULL,
  earned_at TIMESTAMPTZ DEFAULT now(),
  UNIQUE(user_id, badge_id)
);

-- Indexes for performance
CREATE INDEX idx_study_sessions_user_date ON study_sessions(user_id, date);
CREATE INDEX idx_practice_attempts_user ON practice_attempts(user_id);
CREATE INDEX idx_section_progress_user ON section_progress(user_id);
```

PENDING MIGRATION:
```sql
-- Run this in Supabase SQL Editor for promo banner feature
ALTER TABLE profiles
ADD COLUMN IF NOT EXISTS promo_dismissed_at TIMESTAMPTZ DEFAULT NULL;
```

================================================================================
9. DATA MODELS
================================================================================

PROFILE (TypeScript):
```typescript
interface Profile {
  id: string;
  email: string;
  full_name: string | null;
  state_code: string | null;
  target_completion_date: string | null;
  discipline_choice: 'TCP' | 'BAR' | 'ISC' | null;
  weekly_study_hours: number | null;
  working_full_time: boolean | null;
  total_points: number;
  badge_count: number;
  achievement_count: number;
  current_streak: number;
  longest_streak: number;
  last_study_date: string | null;
  promo_dismissed_at: string | null;
  created_at: string;
  updated_at: string;
}
```

PRACTICE QUESTION:
```typescript
interface PracticeQuestion {
  id: string;
  section: SectionCode;
  topic: string;
  difficulty: 'easy' | 'medium' | 'hard';
  question: string;
  options: {
    A: string;
    B: string;
    C: string;
    D: string;
  };
  correctAnswer: 'A' | 'B' | 'C' | 'D';
  explanation: string;
  tip?: string;
}

interface QuestionSet {
  section: SectionCode;
  sectionName: string;
  topics: string[];
  questions: PracticeQuestion[];
}
```

SCORE RELEASE DATE:
```typescript
interface ScoreReleaseDate {
  date: string;
  type: "core" | "discipline";
  testingWindow?: string;
  sections: string[];
  notes?: string;
}
```

STATE REQUIREMENT:
```typescript
interface StateRequirement {
  code: string;           // "CA", "TX", etc.
  name: string;           // "California"
  boardName: string;
  boardUrl: string;
  educationRequirements: {
    totalCredits: number;
    accountingCredits: number;
    businessCredits: number;
    notes: string[];
  };
  experienceRequirements: {
    totalHours: number;
    yearsRequired: number;
    supervisionRequired: boolean;
    acceptableExperience: string[];
  };
  examRequirements: {
    canSitBeforeDegree: boolean;
    creditTransfer: boolean;
    notes: string[];
  };
  fees: {
    initialApplication: number;
    perSection: number;
    reexamFee: number;
    notes: string[];
  };
  ethicsExam: {
    required: boolean;
    examName: string;
    whenRequired: string;
  };
  residency: {
    required: boolean;
    notes: string;
  };
}
```

================================================================================
10. API REFERENCE
================================================================================

POST /api/submit-study-plan
---------------------------
Request:
```json
{
  "email": "user@example.com",
  "workingFullTime": "yes" | "no",
  "hoursPerWeek": "10" | "20" | "30" | "40",
  "accountingBackground": "strong" | "moderate" | "limited",
  "disciplineSection": "TCP" | "BAR" | "ISC",
  "studyPlan": { ... }
}
```
Response: { "success": true }

Actions:
1. Sends formatted study plan email to user
2. Sends lead notification to admin (EMAIL_TO)


POST /api/subscribe-score-release
---------------------------------
Request: { "email": "user@example.com" }
Response: { "success": true }

Actions:
1. Sends confirmation email to user
2. Notifies admin of new subscriber


POST /api/subscribe-nts
-----------------------
Request:
```json
{
  "email": "user@example.com",
  "ntsDate": "2025-01-15",
  "expirationDate": "2025-07-15T00:00:00.000Z"
}
```
Response: { "success": true }

Actions:
1. Sends confirmation with reminder schedule to user
2. Notifies admin of new subscriber

================================================================================
11. STYLING GUIDE
================================================================================

CSS VARIABLES (defined in globals.css):
```css
:root {
  --background: #ffffff;
  --foreground: #1a1a2e;
  --primary: #1e3a5f;        /* Navy blue - main brand */
  --primary-light: #2d5a87;
  --primary-dark: #152a45;
  --secondary: #16a34a;      /* Green - CTAs, success */
  --secondary-light: #22c55e;
  --accent: #0ea5e9;         /* Blue - links, highlights */
  --muted: #64748b;          /* Gray - secondary text */
  --muted-light: #94a3b8;
  --border: #e2e8f0;
  --card: #f8fafc;           /* Light gray - backgrounds */
}
```

SECTION COLORS:
```typescript
const sectionColors = {
  FAR: "#1e3a5f",  // Navy (primary)
  AUD: "#0891b2",  // Cyan
  REG: "#7c3aed",  // Purple
  TCP: "#16a34a",  // Green (secondary)
  BAR: "#dc2626",  // Red
  ISC: "#ea580c",  // Orange
};
```

BUTTON CLASSES:
```css
.btn-primary    /* Navy background, white text */
.btn-secondary  /* Green background, white text */
```

COMMON PATTERNS:
- Cards: `bg-white rounded-xl p-6 border border-[var(--border)]`
- Sections: `py-12` or `py-16` for vertical spacing
- Max width: `max-w-7xl mx-auto px-4 sm:px-6 lg:px-8`
- Headings: `text-[var(--foreground)]` with appropriate size
- Muted text: `text-[var(--muted)]`

================================================================================
12. PRACTICE QUESTIONS SYSTEM
================================================================================

OVERVIEW:
- 5,810 total questions across 176 batch files
- Original 600 in TypeScript files (src/lib/data/practice-questions/)
- Expanded 5,200+ in JSON batch files (docs/question-batches/)
- Immediate feedback with explanations
- Accuracy tracking by section
- History review with filtering
- Exam simulation mode with timed tests

QUESTION DISTRIBUTION (as of 2026-01-08):
| Section | Questions | Batches | Easy% | Med% | Hard% |
|---------|-----------|---------|-------|------|-------|
| FAR     | 1,680     | 55      | 19%   | 46%  | 35%   |
| AUD     | 1,015     | 29      | 18%   | 52%  | 30%   |
| REG     | 1,260     | 36      | 16%   | 47%  | 36%   |
| TCP     | 805       | 23      | 17%   | 51%  | 32%   |
| BAR     | 490       | 14      | 17%   | 56%  | 27%   |
| ISC     | 560       | 16      | 15%   | 50%  | 35%   |
| TOTAL   | 5,810     | 176     | 17%   | 49%  | 33%   |

Target Distribution: 17% easy, 55% medium, 28% hard
Current Gap: Need ~336 more medium questions to reach 55% target

FILES - Original TypeScript:
- src/lib/data/practice-questions/types.ts: PracticeQuestion, QuestionSet interfaces
- src/lib/data/practice-questions/index.ts: Exports, helper functions
- src/lib/data/practice-questions/{far,aud,reg,tcp,bar,isc}.ts: 100 questions each

FILES - JSON Batch System:
- docs/question-batches/{section}/{section}-batch-{number}-{topic}.json
- docs/DIFFICULTY-DISTRIBUTION-ANALYSIS.md: Complete breakdown of all batches
- Batch naming: far-batch-001 through far-batch-055, etc.

QUESTION STRUCTURE:
Each question has:
- id: Unique identifier (e.g., "far-001", "far-med-015")
- section: FAR, AUD, REG, TCP, BAR, or ISC
- topic: Specific topic within section
- difficulty: easy, medium, or hard
- question: The question text
- options: A, B, C, D answer choices
- correctAnswer: A, B, C, or D
- explanation: Why the answer is correct
- tip (optional): Additional study tip

TOPICS COVERED:
- FAR: Conceptual Framework, Revenue Recognition, Leases, Government, NFP,
       Consolidations, Foreign Currency, Derivatives, Pensions, etc.
- AUD: Ethics, Risk Assessment, Evidence, Sampling, Reports, Reviews,
       Government Auditing, Group Audits, etc.
- REG: Individual Tax, Business Tax, Property Transactions, Business Law,
       Circular 230, Gift/Estate Tax, etc.
- TCP: Tax Planning, Estate Tax, Retirement, International Tax,
       Business Succession, Passive Activities, etc.
- BAR: Financial Analysis, Cost Accounting, Budgeting, Data Analytics,
       Capital Budgeting, Derivatives, etc.
- ISC: IT Controls, Cybersecurity, Data Management, Cloud, IT Audit,
       SOC Reports, Encryption, Disaster Recovery, etc.

HELPER FUNCTIONS:
```typescript
getQuestionsBySection(section: SectionCode): PracticeQuestion[]
getQuestionsByTopic(section: SectionCode, topic: string): PracticeQuestion[]
getQuestionsByDifficulty(section, difficulty): PracticeQuestion[]
getRandomQuestions(section, count, options?): PracticeQuestion[]
getQuestionById(id: string): PracticeQuestion | undefined
getTopicsForSection(section: SectionCode): string[]
getQuestionCount(section: SectionCode): number
sectionHasQuestions(section: SectionCode): boolean
```

================================================================================
12.5 EXAM SIMULATION SYSTEM
================================================================================

OVERVIEW:
The exam simulation feature provides timed practice tests that mimic the real
CPA exam experience with pause functionality for flexibility.

LOCATION: src/app/dashboard/exam-simulation/[section]/page.tsx

EXAM STATES:
- 'setup': Configure exam (question count, time limit)
- 'exam': Active exam with timer running
- 'paused': Exam paused, timer stopped
- 'review': Review answers before final submission
- 'results': View final score and explanations

PAUSE FUNCTIONALITY (Added 2026-01-08):
- Pause button in timer bar during exam
- Timer stops when paused, resumes correctly
- Paused overlay shows:
  * Current progress (question X of Y)
  * Questions answered count
  * Resume button
  * "End Exam & Submit" option for early termination
- Records question time before pausing

KEY FUNCTIONS:
```typescript
handlePause(): void     // Stops timer, records time, sets paused state
handleResume(): void    // Resets question start time, returns to exam state
handleEndExam(): void   // Submits exam early from paused state
```

================================================================================
12.6 TBS (TASK-BASED SIMULATION) SYSTEM (NEW 2026-01-10)
================================================================================

OVERVIEW:
TBS questions simulate the actual CPA exam format with multi-step scenarios,
exhibits, and various response types. Created to complement MCQ practice.

LOCATION: src/lib/data/tbs/

FILES:
- types.ts: TBSQuestion, TBSExhibit, TBSRequirement interfaces
- tbs-research-guide.md: Research documentation and creation guidelines
- far-tbs.ts: 19 FAR TBS questions
- aud-tbs.ts: 29 AUD TBS questions
- reg-tbs.ts: 30 REG TBS questions
- tcp-tbs.ts: 21 TCP TBS questions
- bar-tbs.ts: 21 BAR TBS questions
- isc-tbs.ts: 12 ISC TBS questions
- sample-tbs.ts: 58 original sample TBS
- index.ts: Central exports and helper functions

CURRENT STATUS (2026-01-10):
- Total TBS: 500+ questions (COMPLETED January 2026)
- All 6 sections: FAR, AUD, REG, TCP, BAR, ISC (~75+ each)
- Distribution: ~25% easy, ~60% medium, ~15% hard per section

TBS TYPES:
- numeric_entry: Calculate and enter numeric values
- document_review: Review documents, identify errors/issues
- journal_entry: Create journal entries with debits/credits
- dropdown: Select from option lists
- research: Find authoritative literature citations

COMPLEXITY LEVELS:
| Level    | Requirements | Exhibits | Time Est. | Distribution |
|----------|--------------|----------|-----------|--------------|
| Simple   | 3-5          | 1-2      | 8-12 min  | 40%          |
| Moderate | 5-7          | 2-3      | 12-16 min | 45%          |
| Complex  | 7-10         | 3-4      | 16-22 min | 15%          |

TBS QUESTION STRUCTURE:
```typescript
interface TBSQuestion {
  id: string;                    // e.g., "tbs-far-012"
  section: SectionCode;          // FAR, AUD, REG, TCP, BAR, ISC
  tbsType: TBSType;              // numeric_entry, document_review, etc.
  topic: string;                 // e.g., "Leases"
  subtopic: string;              // e.g., "Lessee Accounting - Operating Lease"
  difficulty: Difficulty;        // easy, medium, hard
  skillLevel: SkillLevel;        // remembering_understanding, application, analysis, evaluation
  contentArea: string;           // e.g., "FAR-III"
  title: string;                 // Display title
  scenarioText: string;          // Main scenario description
  timeEstimateMinutes: number;   // Estimated completion time
  maxScorePoints: number;        // Total points available
  exhibits: TBSExhibit[];        // Tables, documents, memos
  requirements: TBSRequirement[]; // Individual questions/tasks
  journalAccounts?: JournalAccount[]; // For journal_entry type
}
```

HELPER FUNCTIONS:
```typescript
getAllTBSQuestions(): TBSQuestion[]     // Get all TBS across sections
getTBSBySection(section): TBSQuestion[] // Get TBS for specific section
```

================================================================================
13. GAMIFICATION SYSTEM
================================================================================

POINTS:
- Study session: 10 points per hour logged
- Practice question correct: 5 points
- Practice question incorrect: 1 point (participation)
- Section passed: 100 points

STREAKS:
- Tracked by consecutive days with logged study sessions
- Current streak and longest streak stored in profile
- Calculated when logging sessions

BADGES (Examples):
- First Study Session
- 7-Day Streak
- 30-Day Streak
- 100 Practice Questions
- Section Passed (per section)
- All Core Sections Passed
- CPA Complete

STORAGE:
- Points: profiles.total_points
- Badges: user_badges table (badge_id + earned_at)
- Streak: profiles.current_streak, profiles.longest_streak

================================================================================
14. FUTURE ROADMAP
================================================================================

IMMEDIATE (Ready to Start):

**CRITICAL: Before creating ANY TBS, read docs/tbs-system-architecture.md**

TBS EXPANSION - COMPLETED (January 2026):
- [x] Phase 1: Reached 200 TBS
- [x] Phase 2: Expanded to 350 TBS
- [x] Phase 3: Expanded to 500+ TBS (75+ per section)
      See docs/TBS_EXPANSION_2026-01-10.md for full documentation
      Complexity: 40% simple, 45% moderate, 15% complex
      See CURRENT_STATUS_2026-01-10.txt for full ID numbering

PHASE 3 - Other tasks:
- [ ] Continue adding medium MCQ questions (~336 more needed for 55% target)
      Priority sections: FAR (46%), REG (47%)
- [ ] Phase 4: Email Nurturing
  - [ ] Design 7-email welcome sequence
  - [ ] Set up email automation (Resend + cron or external service)
  - [ ] Implement segment tracking

SHORT-TERM:
- [x] Practice questions expanded to 5,810 (was 600)
- [ ] Continue balancing difficulty distribution
- [ ] Add remaining 28 states to requirements guide
- [ ] More blog posts for SEO
- [ ] Diagnostic quizzes per section

MEDIUM-TERM (Phase 5):
- [ ] Integrate Anthropic Claude API for chatbot
- [ ] AI-powered study recommendations
- [ ] Enhanced progress analytics

LONG-TERM:
- [ ] Mobile app (PWA)
- [ ] Video content integration
- [ ] Community features (forums, study groups)
- [ ] Referral program

WISHLIST:
- Exit-intent popup for email capture
- A/B testing infrastructure
- Admin dashboard for content management
- Integration with other CPA review providers (if needed)

================================================================================
KEY DOCUMENTS REFERENCE
================================================================================

**MUST READ FIRST (Before creating ANY TBS):**

1. **docs/tbs-system-architecture.md** (CRITICAL - READ FIRST!)
   - Complete TBS creation guidelines and standards
   - TypeScript interfaces and type definitions
   - Exhibit structure templates
   - Quality requirements and validation rules
   - FOLLOW THIS DOCUMENT PRECISELY FOR ALL TBS CREATION

**Session Context:**

2. **CURRENT_STATUS_2026-01-10.txt** (CRITICAL)
   - Detailed instructions for resuming current work
   - TBS Expansion: COMPLETED - 500+ TBS across all 6 sections
   - See docs/TBS_EXPANSION_2026-01-10.md for documentation
   - Distribution targets and ID numbering
   - READ THIS for immediate pickup

3. **src/lib/data/tbs/tbs-research-guide.md**
   - CPA exam TBS research and background
   - Complexity level definitions (40% simple, 45% moderate, 15% complex)
   - Topic priorities by section
   - TBS type descriptions and best practices

**TBS Question Files:**

4. **src/lib/data/tbs/*.ts** (TBS FILES)
   - types.ts: TBS type definitions (TBSQuestion, TBSExhibit, TBSRequirement)
   - far-tbs.ts: 19 FAR TBS (need 10 more for Phase 1, then ~33 more for Phase 2)
   - aud-tbs.ts: 29 AUD TBS (need ~33 more for Phase 2)
   - reg-tbs.ts: 30 REG TBS (need ~33 more for Phase 2)
   - tcp-tbs.ts: 21 TCP TBS (need ~17 more for Phase 2)
   - bar-tbs.ts: 21 BAR TBS (need ~17 more for Phase 2)
   - isc-tbs.ts: 12 ISC TBS (need ~17 more for Phase 2)
   - sample-tbs.ts: 58 original sample TBS
   - index.ts: Central exports and helper functions

**MCQ Reference:**

5. docs/DIFFICULTY-DISTRIBUTION-ANALYSIS.md (Updated 01/08)
   - Complete breakdown of all 5,810 MCQ questions
   - Distribution by section, difficulty, and batch
   - Gap analysis for reaching target distribution
   - Lists all 176 question batch files

6. docs/question-batches/ (MCQ JSON files)
   - Contains all question batch JSON files organized by section
   - Format: {section}-batch-{number}-{topic}.json

**Other Reference:**

7. CPA Exam Blueprint - Business Overview.txt
   - Complete business description for Surgent team
   - Marketing funnel explanation

8. cpa claude responses.txt
   - All strategic planning responses
   - Technical decisions and explanations

9. SESSION_PROMPT.txt
   - Quick start guide for new sessions
   - Current state overview

10. SESSION_LOG.txt
    - Detailed session-by-session accomplishments
    - Commits and technical details

================================================================================
END OF CONTEXT FILE
================================================================================
